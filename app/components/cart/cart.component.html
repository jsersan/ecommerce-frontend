<!-- Overlay para el fondo oscurecido -->
<div class="cart-overlay"></div>

<!-- Contenedor principal del popup -->
<div class="cart-popup">
  <!-- Cabecera del carrito con título y botón de cierre -->
  <div class="cart-header">
    <h2>Tu Carrito</h2>
    <button class="close-cart" (click)="closeCart()">×</button>
  </div>
  
  <!-- Contenedor principal del contenido -->
  <div class="cart-content">
    <!-- Vista para carrito vacío -->
    <div *ngIf="cartItems.length === 0" class="empty-cart">
      <h2>Tu carrito está vacío</h2>
      <p>Añade algunos productos para continuar con la compra</p>
      <button class="btn btn-primary" routerLink="/" (click)="closeCart()">Explorar productos</button>
    </div>
    
    <!-- Vista para carrito con productos -->
    <div *ngIf="cartItems.length > 0" class="vercarrito">
      <div class="table-header">
        <div class="header-articulo">Artículo</div>
        <div class="header-cantidad">Cantidad</div>
        <div class="header-precio">Precio(u)</div>
        <div class="header-total">Precio (total)</div>
        <div class="header-acciones"></div>
      </div>
      
      <div class="table-divider"></div>
      
      <div class="cart-items-container">
        <!-- Repetir para cada item del carrito -->
        <div class="cart-item" *ngFor="let item of cartItems">
          <div class="item-articulo">
            <img [src]="item.imagen" alt="imagen producto" class="miniatura" />
            <span class="nombre-producto">{{ item.nombre }}</span>
          </div>
          
          <div class="item-cantidad">
            <button class="btn-cantidad" (click)="changeQuantity($event, item.id, item.color, item.cantidad - 1)" [disabled]="item.cantidad <= 1">-</button>
            <span class="cantidad-valor">{{ item.cantidad }}</span>
            <button class="btn-cantidad" (click)="changeQuantity($event, item.id, item.color, item.cantidad + 1)">+</button>
          </div>
          
          <div class="item-precio">{{ item.precio | currency:'EUR':'symbol':'1.2-2' }}</div>
          
          <div class="item-total">{{ item.precio * item.cantidad | currency:'EUR':'symbol':'1.2-2' }}</div>
          
          <div class="item-acciones">
            <button class="btn-eliminar" (click)="confirmRemoveItem($event, item.id, item.color)">×</button>
          </div>
        </div>
      </div>
      
      <div class="table-divider"></div>
      
      <!-- Línea del total -->
      <div class="cart-total">
        <span class="total-label">Total:</span>
        <span class="total-value">{{ total | currency:'EUR':'symbol':'1.2-2' }}</span>
      </div>
    </div>
  </div>
  
  <!-- Botón para proceder al checkout -->
  <button *ngIf="cartItems.length > 0" id="procesarcompra" (click)="checkout()">PROCESAR COMPRA</button>
</div>